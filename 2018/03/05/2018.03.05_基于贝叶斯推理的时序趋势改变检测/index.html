<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Trend change detection," />





  <link rel="alternate" href="/atom.xml" title="Memicat's blog!" type="application/atom+xml" />






<meta name="description" content="This paper elaborates a Bayesian method to estimate the location of the singularities and to produce some confidence intervals. And then validate the ability and sensitivity of the inference method.">
<meta name="keywords" content="Trend change detection">
<meta property="og:type" content="article">
<meta property="og:title" content="基于贝叶斯推理的时序趋势改变检测">
<meta property="og:url" content="http://memicat.com/2018/03/05/2018.03.05_基于贝叶斯推理的时序趋势改变检测/index.html">
<meta property="og:site_name" content="Memicat&#39;s blog!">
<meta property="og:description" content="This paper elaborates a Bayesian method to estimate the location of the singularities and to produce some confidence intervals. And then validate the ability and sensitivity of the inference method.">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://memicat.com/images/2018.3.05_1.png">
<meta property="og:image" content="http://memicat.com/images/2018.3.05_4.png">
<meta property="og:image" content="http://memicat.com/images/2018.3.05_2.png">
<meta property="og:image" content="http://memicat.com/images/2018.3.05_3.png">
<meta property="og:updated_time" content="2018-03-08T18:46:44.259Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于贝叶斯推理的时序趋势改变检测">
<meta name="twitter:description" content="This paper elaborates a Bayesian method to estimate the location of the singularities and to produce some confidence intervals. And then validate the ability and sensitivity of the inference method.">
<meta name="twitter:image" content="http://memicat.com/images/2018.3.05_1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://memicat.com/2018/03/05/2018.03.05_基于贝叶斯推理的时序趋势改变检测/"/>





  <title>基于贝叶斯推理的时序趋势改变检测 | Memicat's blog!</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Memicat's blog!</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Work rationally, life emotionally!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://memicat.com/2018/03/05/2018.03.05_基于贝叶斯推理的时序趋势改变检测/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Memicat">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memicat's blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">基于贝叶斯推理的时序趋势改变检测</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-05T00:00:00+01:00">
                2018-03-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Data-Mining/" itemprop="url" rel="index">
                    <span itemprop="name">Data Mining</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/03/05/2018.03.05_基于贝叶斯推理的时序趋势改变检测/" class="leancloud_visitors" data-flag-title="基于贝叶斯推理的时序趋势改变检测">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>

                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>This paper elaborates a Bayesian method to estimate the location of the singularities and to produce some confidence intervals. And then validate the ability and sensitivity of the inference method.<br><a id="more"></a></p>
<h3 id="1-Formulation-of-the-linear-mixed-model"><a href="#1-Formulation-of-the-linear-mixed-model" class="headerlink" title="1. Formulation of the linear mixed model"></a>1. Formulation of the linear mixed model</h3><p>This paper proposes two aspects of change points in a time series：</p>
<ol>
<li>A change point is commonly associated with a sudden change of local trend in the data.</li>
<li>Systematic evolution of the local variability around its average value undergoes a sudden transition at the change point.</li>
</ol>
<p>Above two aspects of change point can be combined into a <strong>Linear Mixed Model(LMM)</strong> with hyperparameters.</p>
<p>The simplest type of signal undergoing a change point at time θ can be expressed as:</p>
<script type="math/tex; mode=display">
\begin{equation}
y(t)=\beta_0+\beta_1{|\theta-t|}_\_+\beta_2{|\theta-t|}_++ξ(t).
\end{equation}</script><p>Use the elementary Hockey sticks of first order defined through:</p>
<script type="math/tex; mode=display">
\begin{equation}
|\theta-t|_\_=(\zeta_\_^\theta)=
\begin{cases}
\theta-t,& \text{if $t \le \theta$} \\
0,& \text{else}
\end{cases}
,
\end{equation}</script><script type="math/tex; mode=display">

\begin{equation}
|\theta-t|_+=(\zeta_+^\theta)=
\begin{cases}
\theta-t,& \text{if $t \ge \theta$} \\
0,& \text{else}
\end{cases}
.
\end{equation}</script><p> <strong>Random fluctuations</strong> can be caused by <strong>measurement noise</strong> and some <strong>intrinsic variability</strong>, which is not captured by the low dimensional mean dynamics on both sides of the change point θ. So here we consider stochastic fluctuations ξ(t) whose amplitudes undergo a transition themselves according to:</p>
<script type="math/tex; mode=display">
 \begin{equation}
STD(ξ(t))=\sigma(1+s_1{|t-\theta|}_\_+s_2{|t-\theta|}_+).
 \end{equation}</script><p> The scale factor σ could be the level of the measurement noise or some background level of the intrinsic fluctuations, whereas the constants s1,2 describe the systematic evolution of the models intrinsic variability prior and after the change point measured in units of σ. Assume the Gaussian random variables, different time points are uncorrelated (It is not ture in practice).<br> <img src="/images/2018.3.05_1.png" alt=""><br>Given a data set of n time points $t_i, i = 1,…,n$, the observation vector $ \vec {\mkern1mu y} = [s(t_i)]^t ∈ R^n$ can be written as follows:</p>
<script type="math/tex; mode=display">
\begin{equation}
\vec{\mkern1mu y} =\vec{\mkern1mu F}\vec{\mkern1mu \beta}+\vec{ ξ}
\end{equation}</script><p>$\beta = (\beta_0,\beta_1,\beta_2)^T \in R^3$ is the fixed effect vector, corresponding to the coefficients of the LMM for mean behavior.$F \in R^3$ is the system matrix of the fixed effects.</p>
<script type="math/tex; mode=display">
\begin{equation}
F_\theta=
\left(
  \begin{array}{ccc}
  1 & {(\zeta_\_^\theta)}_1& {(\zeta_+^\theta)}_1 \\
  \vdots & \vdots &  \vdots \\
  1 & {(\zeta_\_^\theta)}_n &  {(\zeta_+^\theta)}_n \\
  \end{array}
\right)
\end{equation}</script><p>And noise $ξ ∈ R^n$ is a Gaussian random vector with zero mean and covariance matrix $σ^2Ω ∈ R^{n×n}$,</p>
<script type="math/tex; mode=display">
\begin{equation}
ξ \sim N（0,\sigma^2 \Omega).
\end{equation}</script><p>The covariance itself is structured noise parametrized by two slope parameters $s = (s_1,s_2)$ and the change point θ itself as:</p>
<script type="math/tex; mode=display">
\begin{equation}
{(\Omega_{\theta,s_1,s_2})}_{ij}=([1+s_1{(\zeta_\_^\theta)}_j+s_2{(\zeta_+^\theta)}_j]^2))\times \delta_{ij}
\end{equation}</script><p>So the probability density of the observations for fixed parameters (i.e. fixed effects, change point, slope parameters) can be written as</p>
<script type="math/tex; mode=display">
\begin{equation}
\vec{\mkern1mu y} \sim N(\vec{\mkern1mu F}\hat{\mkern1mu \beta},\sigma^2\Omega).
\end{equation}</script><p>The Likelihood function of the parameters given the data can then be written as:</p>
<script type="math/tex; mode=display">
\begin{equation}
\mathcal{L}（\beta,\sigma,s,\theta|y） = \frac{1}{(2\pi\sigma^2)^{n/2}\sqrt{|\Omega|}}e^{-\frac{1}{2\sigma^2}(y-F\beta)^T\Omega^{-1}(y-F\beta)}
\end{equation}</script><h3 id="2-Bayesian-inversion"><a href="#2-Bayesian-inversion" class="headerlink" title="2. Bayesian inversion"></a>2. Bayesian inversion</h3><p>Assume a priori no correlations between the parameters, the joint prior distribution can be factorized into the independent parts:</p>
<script type="math/tex; mode=display">
\begin{equation}
p(\beta,\sigma,\theta,s)=p(\theta)\cdotp(\sigma)\cdotp(s)\cdotp(\beta).
\end{equation}
\\.
\\.
\\.</script><script type="math/tex; mode=display">
\begin{equation}
p(\sigma,\theta,\boldsymbol{s|y}) \sim
 \frac{\sigma^{1-n}}{\sqrt{|\Omega||F^T\Omega^{-1}F|}} e^{^{-\frac{1}{2\sigma^2}R^2}}
\end{equation}</script><p>and</p>
<script type="math/tex; mode=display">
\begin{equation}
p(\beta,\theta,\boldsymbol{s|y}) \sim \frac{[(y-F\beta)^T\Omega^{-1}(y-F\beta)]^{-n/2}}{\sqrt{|\Omega|}}
\end{equation}</script><p>Further marginalization may be performed to yield</p>
<script type="math/tex; mode=display">
\begin{equation}
\begin{split}
p(\theta,s|y)
&= \int d\sigma d\beta p(\beta,\sigma,\theta,s|y)\\
&=C^\prime \cdot \frac{R^{-(n-2)}}{\sqrt{|\Omega||F^T\Omega^{-1}F|}}.
\end{split}
\end{equation}</script><p>$C^\prime$ is a constant. Finally the posterior marginal distribution of θ can be computed by numeric evaluation of the following integral:</p>
<script type="math/tex; mode=display">
\begin{equation}
p(\theta|\boldsymbol{y}) = \int d\boldsymbol{s} p(\theta,\boldsymbol{s|y}).
\end{equation}</script><p>In the same way the numeric θ integral may be performed to elaborate the posterior information about the involved slope parameters s of the heteroscedastic behavior around the change point:</p>
<script type="math/tex; mode=display">
\begin{equation}
p(\boldsymbol{s|y}) = \int d\theta p(\theta,\boldsymbol{s|y}).
\end{equation}</script><h3 id="3-Local-posterior-density"><a href="#3-Local-posterior-density" class="headerlink" title="3. Local posterior density"></a>3. Local posterior density</h3><p>This paper proposes a kernel based local posterior method. Around each time point t we choose a data window <script type="math/tex">I_t = [t− T/2,t+ T/2 ]</script> of length T. Inside this window, we take as prior distribution for the change point location p(θ) a flat prior inside some subinterval of length a:</p>
<script type="math/tex; mode=display">
\begin{equation}
p(\theta)=
\begin{cases}
1/a,& \text{for $t-\frac{a}{2} \le \theta \le t+\frac{a}{2}$} \\
0,& \text{else}
\end{cases}
,0<a<T.
\end{equation}</script><p>We then compute the local posterior <script type="math/tex">p_t(θ|y_{|I_t})</script> around t based on the subseries in the data window <script type="math/tex">y_{|I_t}</script>. This yields a posterior distribution of a possible change point within each window under the assumption that there is actually a singularity within the window.<br>……After lots of inference step, we will use a plain Bayes factor BF.<br>For example,to infer on the true change point values $(θ_1,θ_2,θ_3)$ = (40,100,160) via the estimators $(\hat{\mkern1mu \theta_1} , \hat{\mkern1mu \theta_2} , θ\hat{\mkern1mu \theta_3} ) = (38.9, 93.0, 162.9)$ within their intervals ([33.9, 47.8], [87.5, 109.1], [158.9, 167.0]) of about 90% confidence.</p>
<p><img src="/images/2018.3.05_4.png" alt="" title="Fig.2 Normalized sum of local posterior densities weighted by the Bayes factor, computed for sub time series of nsub = 50 data points and a sampling grid of ncp = 30 change points."></p>
<h3 id="4-Validation-the-method"><a href="#4-Validation-the-method" class="headerlink" title="4. Validation the method"></a>4. Validation the method</h3><p>Demonstrate the technique by applying it on a time series including a known significant change point. For this purpose we analyze the annual Nile River flow measured at Aswan from 1871 to 1970 [27]. And the year 1899 has been verified as the change point. So we want to verify the previous model by this dataset.<br>First of all we compute the global posterior density p(θ,s|y) as presented in Eq.(15). By initially guessing a reasonable sampling grid for the change point θ and the slope parameters s from the data, we clearly obtain significant maxima in the posterior projections p(θ|y) and p(s|y). And adjust the sampling to obatain finner posterior structures. Finally get the estimator the change point as <script type="math/tex">\hat{\mkern1mu \theta} = 1898</script> within a confidence interval [1895,1901] of over 95%. The slope parameters of the deviation are estimated as <script type="math/tex">(\hat{\mkern1mu s_1},\hat{\mkern1mu s_2}) = (0.0065, −0.0015)</script> within the 90% confidence intervals $\hat{\mkern1mu s_1}$ in [−0.0190, 0.0450] and$ \hat{\mkern1mu s_2}$ in [−0.0065, 0.0855].<br>Then use the estimator $\hat{\mkern1mu \theta}$ and $\hat{\mkern1mu s}$ to compute the posterior projections p(β,θ,s|y) and p(σ,θ,s|y) formulated in Eq.(12) and (13), and then estimate the remaining parameters $\beta$ and $\sigma$. Finally we reveal from the global posterior distribution the most probable model plotted in Fig.2 and listed in Tab.II.<br> <img src="/images/2018.3.05_2.png" alt="" title="Figure 3: Annual Nile flow containing a known change point at θ = 1899. The sum of localized posterior densities weighted with respect to the Bayes factor BF indicates a change point at $\hat{\mkern1mu \theta}$ = 1898 within its confidence interval [1896, 1900] of about 90%. The estimated underlying model reveals the most dominant transition in the behavior of the mean."><br><img src="/images/2018.3.05_3.png" alt=""><br>Since most secondary maxima are &lt; 1% we ignore them and therefore conclude on one global change point at $\hat{\mkern1mu \theta}$ = 1898 in the interval [1896, 1900] of about 90% confidence.</p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>Schütz N, Holschneider M. Detection of trend changes in time series using Bayesian inference[J]. Physical Review E, 2011, 84(2): 021120.</p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Donate comment here</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechat.jpg" alt="Memicat WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Memicat Alipay"/>
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Trend-change-detection/" rel="tag"># Trend change detection</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/04/2018.03.04_数据挖掘基本算法/" rel="next" title="数据挖掘基本算法">
                <i class="fa fa-chevron-left"></i> 数据挖掘基本算法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
  <div class="bdsharebuttonbox">
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
    <a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a>
    <a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
    <a href="#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a>
    <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
    <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a class="bds_count" data-cmd="count"></a>
  </div>
  <script>
    window._bd_share_config = {
      "common": {
        "bdText": "",
        "bdMini": "2",
        "bdMiniList": false,
        "bdPic": ""
      },
      "share": {
        "bdSize": "16",
        "bdStyle": "0"
      },
      "image": {
        "viewList": ["tsina", "douban", "sqq", "qzone", "weixin", "twi", "fbook"],
        "viewText": "分享到：",
        "viewSize": "16"
      }
    }
  </script>

<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="Memicat" />
            
              <p class="site-author-name" itemprop="name">Memicat</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/MengleiMin" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/mengleimin" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:mengleimin@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.douban.com/people/139512560" target="_blank" title="Douban">
                      
                        <i class="fa fa-fw fa-globe"></i>Douban</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Formulation-of-the-linear-mixed-model"><span class="nav-text"><a href="#1-Formulation-of-the-linear-mixed-model" class="headerlink" title="1. Formulation of the linear mixed model"></a>1. Formulation of the linear mixed model</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Bayesian-inversion"><span class="nav-text"><a href="#2-Bayesian-inversion" class="headerlink" title="2. Bayesian inversion"></a>2. Bayesian inversion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Local-posterior-density"><span class="nav-text"><a href="#3-Local-posterior-density" class="headerlink" title="3. Local posterior density"></a>3. Local posterior density</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Validation-the-method"><span class="nav-text"><a href="#4-Validation-the-method" class="headerlink" title="4. Validation the method"></a>4. Validation the method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reference"><span class="nav-text"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Memicat</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT </a></div>




<span id="busuanzi_container_site_uv">
  &nbsp | &nbspTotal   &nbsp<span id="busuanzi_value_site_uv"></span> views
</span>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://http-memicat-com.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://memicat.com/2018/03/05/2018.03.05_基于贝叶斯推理的时序趋势改变检测/';
          this.page.identifier = '2018/03/05/2018.03.05_基于贝叶斯推理的时序趋势改变检测/';
          this.page.title = '基于贝叶斯推理的时序趋势改变检测';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://http-memicat-com.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  





  

  
  <script src="/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("AvMGnHBDWLRA1xeIA7dpuXat-gzGzoHsz", "TIHdJMbDyqmdFonp6xQR61el");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

  

  


  <script type="text/javascript"
  color="0,0,0" opacity='0.5' zIndex="-2" count="10" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
